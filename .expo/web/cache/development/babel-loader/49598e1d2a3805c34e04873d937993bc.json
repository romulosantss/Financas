{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, createContext, useEffect } from 'react';\nimport firebase from \"../services/firebaseConnection\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport var AuthContext = createContext({});\n\nfunction AuthProvider(_ref) {\n  var children = _ref.children;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      user = _useState2[0],\n      setUser = _useState2[1];\n\n  var _useState3 = useState(true),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  useEffect(function () {\n    function loadStorage() {\n      var storageUser;\n      return _regeneratorRuntime.async(function loadStorage$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem('Auth_user'));\n\n            case 2:\n              storageUser = _context.sent;\n\n              if (storageUser) {\n                setUser(JSON.parse(storageUser));\n                setLoading(false);\n              }\n\n              setLoading(false);\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n\n    loadStorage();\n  }, []);\n\n  function signIn(email, password) {\n    return _regeneratorRuntime.async(function signIn$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return _regeneratorRuntime.awrap(firebase.auth().signInWithEmailAndPassword(email, password).then(function _callee(value) {\n              var uid;\n              return _regeneratorRuntime.async(function _callee$(_context2) {\n                while (1) {\n                  switch (_context2.prev = _context2.next) {\n                    case 0:\n                      uid = value.user.uid;\n                      _context2.next = 3;\n                      return _regeneratorRuntime.awrap(firebase.database().ref('users').child(uid).once('value').then(function (snapshot) {\n                        var data = {\n                          uid: uid,\n                          nome: snapshot.val().nome,\n                          email: value.user.email\n                        };\n                        setUser(data);\n                        storageUser(data);\n                      }));\n\n                    case 3:\n                    case \"end\":\n                      return _context2.stop();\n                  }\n                }\n              }, null, null, null, Promise);\n            }).catch(function (error) {\n              alert(error.code);\n            }));\n\n          case 2:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  function signUp(email, password, nome) {\n    return _regeneratorRuntime.async(function signUp$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            _context5.next = 2;\n            return _regeneratorRuntime.awrap(firebase.auth().createUserWithEmailAndPassword(email, password).then(function _callee2(value) {\n              var uid;\n              return _regeneratorRuntime.async(function _callee2$(_context4) {\n                while (1) {\n                  switch (_context4.prev = _context4.next) {\n                    case 0:\n                      uid = value.user.uid;\n                      _context4.next = 3;\n                      return _regeneratorRuntime.awrap(firebase.database().ref('users').child(uid).set({\n                        saldo: 0,\n                        nome: nome\n                      }).then(function () {\n                        var data = {\n                          uid: uid,\n                          nome: nome,\n                          email: value.user.email\n                        };\n                        setUser(data);\n                        storageUser(data);\n                      }));\n\n                    case 3:\n                    case \"end\":\n                      return _context4.stop();\n                  }\n                }\n              }, null, null, null, Promise);\n            }).catch(function (error) {\n              alert(error.code);\n            }));\n\n          case 2:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  function storageUser(data) {\n    return _regeneratorRuntime.async(function storageUser$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            _context6.next = 2;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem('Auth_user', JSON.stringify(data)));\n\n          case 2:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  return _jsx(AuthContext.Provider, {\n    value: {\n      signed: !!user,\n      user: user,\n      signUp: signUp,\n      signIn: signIn,\n      loading: loading\n    },\n    children: children\n  });\n}\n\nexport default AuthProvider;","map":{"version":3,"sources":["C:/Users/RML-R/Documents/Estudos/app/AppFinancas/src/contexts/auth.js"],"names":["React","useState","createContext","useEffect","firebase","AsyncStorage","AuthContext","AuthProvider","children","user","setUser","loading","setLoading","loadStorage","getItem","storageUser","JSON","parse","signIn","email","password","auth","signInWithEmailAndPassword","then","value","uid","database","ref","child","once","snapshot","data","nome","val","catch","error","alert","code","signUp","createUserWithEmailAndPassword","set","saldo","setItem","stringify","signed"],"mappings":"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","sourcesContent":["import React, { useState, createContext, useEffect } from 'react';\r\nimport firebase from '../services/firebaseConnection';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\nexport const AuthContext = createContext({});\r\n\r\n\r\nfunction AuthProvider({ children }){\r\n    const [user, setUser] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(()=> {\r\n        async function loadStorage(){\r\n            const storageUser = await AsyncStorage.getItem('Auth_user')\r\n\r\n            if(storageUser){\r\n                setUser(JSON.parse(storageUser));\r\n                setLoading(false);\r\n            }\r\n\r\n            setLoading(false);\r\n        }\r\n\r\n        loadStorage();\r\n    }, []);\r\n\r\n    //funcao para logar o usuário\r\n    async function signIn(email, password){\r\n        await firebase.auth().signInWithEmailAndPassword(email, password)\r\n        .then(async (value)=>{\r\n            let uid = value.user.uid;\r\n            await firebase.database().ref('users').child(uid).once('value')\r\n            .then((snapshot)=>{\r\n                let data = {\r\n                    uid: uid,\r\n                    nome: snapshot.val().nome,\r\n                    email: value.user.email\r\n                };\r\n\r\n                setUser(data);\r\n                storageUser(data);\r\n            })\r\n        })\r\n        .catch((error)=>{\r\n            alert(error.code);\r\n        });\r\n    }\r\n\r\n    //Cadastrar o usuário\r\n    async function signUp(email, password, nome){\r\n        await firebase.auth().createUserWithEmailAndPassword(email, password)\r\n        .then(async (value)=>{\r\n            let uid = value.user.uid;\r\n            await firebase.database().ref('users').child(uid).set({\r\n                saldo: 0,\r\n                nome: nome\r\n            })\r\n            .then(()=>{\r\n                let data = {\r\n                    uid: uid,\r\n                    nome: nome,\r\n                    email: value.user.email,\r\n                };\r\n                setUser(data);\r\n                storageUser(data);\r\n            })\r\n        })\r\n        .catch((error)=>{\r\n            alert(error.code);\r\n        });\r\n    }\r\n\r\n    async function storageUser(data){\r\n        await AsyncStorage.setItem('Auth_user', JSON.stringify(data));\r\n    }\r\n\r\n    return(\r\n        <AuthContext.Provider value={{ signed: !!user, user, signUp, signIn, loading}}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n}\r\n\r\nexport default AuthProvider;"]},"metadata":{},"sourceType":"module"}